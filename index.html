const addExpense = async () => {
    if (!newExpense.trim() || !newAmount || !selectedCategory) return;

    const amount = parseFloat(newAmount);
    if (isNaN(amount) || amount <= 0) return;

    const expense = {
      id: Date.now().toString(),
      description: newExpense.trim(),
      amount,
      category: selectedCategory,
      date: new Date().toISOString()
    };

    const updatedExpenses = [...expenses, expense];
    setExpenses(updatedExpenses);
    
    await saveExpenses(updatedExpenses);
    await loadBudgets(); // Reload budgets to trigger recalculation

    setNewExpense('');
    setNewAmount('');
    setSelectedCategory(categories[0]);
  };
